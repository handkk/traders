"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[91],{1979:(w,h,a)=>{a.r(h),a.d(h,{FarmerModule:()=>Y});var u=a(6895),g=a(4575),m=a(433),F=a(4327),d=a(574),e=a(4650),x=a(9651),v=a(1883),T=a(2566),S=a(7570),Z=a(1102),f=a(3679),p=a(6704),z=a(5635),_=a(8231),C=a(6616),A=a(7044),N=a(1811),c=a(1949),b=a(6497),P=a(1634);function y(r,i){1&r&&(e.TgZ(0,"nz-select",32),e._UZ(1,"nz-option",33),e.qZA())}function J(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"span",35),e.NdJ("click",function(){e.CHM(n);const o=e.oxw(2);return e.KtG(o.clearfield("address"))}),e.qZA()}}function O(r,i){if(1&r&&e.YNc(0,J,1,0,"span",34),2&r){const n=e.oxw();e.Q6J("ngIf",n.validateForm.controls.address.value)}}function U(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"span",35),e.NdJ("click",function(){e.CHM(n);const o=e.oxw(2);return e.KtG(o.clearfield("notes"))}),e.qZA()}}function E(r,i){if(1&r&&e.YNc(0,U,1,0,"span",34),2&r){const n=e.oxw();e.Q6J("ngIf",n.validateForm.controls.notes.value)}}function Q(r,i){if(1&r){const n=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"a",39),e.NdJ("click",function(){const s=e.CHM(n).$implicit,l=e.oxw(2);return e.KtG(l.editFarmer(s))}),e._UZ(11,"span",40),e.qZA(),e._uU(12,"\xa0\xa0 "),e.TgZ(13,"a",41),e.NdJ("nzOnConfirm",function(){const s=e.CHM(n).$implicit,l=e.oxw(2);return e.KtG(l.confirm(s._id))})("nzOnCancel",function(){e.CHM(n);const o=e.oxw(2);return e.KtG(o.cancel())}),e._UZ(14,"span",42),e.qZA()()()}if(2&r){const n=i.$implicit;e.xp6(2),e.Oqu(n.name),e.xp6(2),e.Oqu(n.phone_number),e.xp6(2),e.Oqu(n.address),e.xp6(2),e.Oqu(n.notes)}}function M(r,i){if(1&r&&(e.TgZ(0,"nz-table",36,37)(2,"thead")(3,"tr")(4,"th"),e._uU(5,"Name"),e.qZA(),e.TgZ(6,"th"),e._uU(7,"Phone Number"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Address"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Notes"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Actions"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,Q,15,4,"tr",38),e.qZA()()),2&r){const n=e.oxw();e.Q6J("nzData",n.farmersData)("nzShowPagination",!1)("nzLoading",n.loading),e.xp6(15),e.Q6J("ngForOf",n.farmersData)}}const q=[{path:"",component:(()=>{class r{constructor(n,t,o,s,l){this.fb=n,this.message=t,this.farmerService=o,this.mainService=s,this.router=l,this.farmersData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name"},{phoneNumber:"Phone Number"},{address:"Address"},{notes:"Note"}],this.index=1,this.total=0,this.pageSize=10,this.loading=!0,this.edit=!1,this.farmerId="",sessionStorage.getItem("userinfo")||(sessionStorage.clear(),this.message.create("warning","User session expired please login"),this.router.navigateByUrl("/login"))}ngOnInit(){this.validateForm=this.fb.group({name:[null,[m.kI.required]],phoneNumberPrefix:["+91"],phoneNumber:[null],address:[null],notes:[null]}),this.getAllFarmers()}getAllFarmers(){this.loading=!0;const n={skip:this.index,limit:this.pageSize};document.getElementById("farmerName")?.focus(),this.farmerService.getFarmers(n).subscribe(t=>{this.farmersData=t.data,this.total=t.total,this.loading=!1},t=>{console.log("get farmers err ",t),this.farmersData=[],this.loading=!1})}clearfield(n){this.validateForm.controls[n].reset()}submitForm(){if(this.validateForm.valid){const n={name:this.validateForm.value.name,phone_number:this.validateForm.value.phoneNumber?parseInt(this.validateForm.value.phoneNumber):null,address:this.validateForm.value.address,notes:this.validateForm.value.notes};this.mainService.spinning.emit(!0),this.edit?this.mainService.updateFarmer(this.farmerId,n).subscribe(t=>{this.message.create("success",`${this.validateForm.value.name} farmer updated Successfully`),this.reset(),this.loading=!0,this.edit=!1,this.mainService.spinning.emit(!1),this.getAllFarmers()},t=>{console.log("get customers err ",t),this.loading=!1,this.mainService.spinning.emit(!1),this.getAllFarmers()}):this.mainService.createFarmer(n).subscribe(t=>{this.message.create("success",`${this.validateForm.value.name} farmer added Successfully`),this.reset(),this.loading=!0,this.mainService.spinning.emit(!1),this.getAllFarmers()},t=>{console.log("get customers err ",t),this.loading=!1,this.mainService.spinning.emit(!1),this.getAllFarmers()})}else this.mainService.spinning.emit(!1),Object.values(this.validateForm.controls).forEach(n=>{n.invalid&&(n.markAsDirty(),n.updateValueAndValidity({onlySelf:!0}))})}editFarmer(n){this.edit=!0,this.farmerId=n._id,this.validateForm.controls.phoneNumber.setValue(n.phone_number),this.validateForm.controls.name.setValue(n.name),this.validateForm.controls.notes.setValue(n.notes),this.validateForm.controls.address.setValue(n.address)}confirm(n){this.mainService.removeFarmer(n).subscribe(t=>{this.loading=!1,t&&t.success&&(this.message.create("success",t.message),this.getAllFarmers())},t=>{console.log("get customers err ",t),this.loading=!1})}cancel(){}exportJsonAsExcelFile(n,t){const s={Sheets:{data:d.P6.json_to_sheet(n)},SheetNames:["data"]},l=d.cW(s,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(l,t)}exportTableAsExcelFile(n,t){const s={Sheets:{data:d.P6.table_to_sheet(n)},SheetNames:["data"]},l=d.cW(s,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(l,t)}saveAsExcelFile(n,t){const o=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});F.saveAs(o,t+(new Date).getTime()+".xlsx")}exportToExcel(){let n=[];this.farmersData.forEach(t=>{n.push({Name:t.name,"Phone Number":t.phone_number,Address:t.address,Notes:t.notes})}),this.exportJsonAsExcelFile(n,"farmers")}reset(){this.validateForm.controls.name.reset(),this.validateForm.controls.phoneNumber.reset(),this.validateForm.controls.address.reset(),this.validateForm.controls.notes.reset(),this.edit=!1}onPageSizeChange(n){this.pageSize=n,this.getAllFarmers()}onPageChange(n){this.index=n,this.getAllFarmers()}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(m.QS),e.Y36(x.dD),e.Y36(v.y),e.Y36(T.J),e.Y36(g.F0))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-farmer"]],decls:54,vars:33,consts:[[1,"customer-form"],["nz-row",""],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-col","","nzSpan","12"],["nz-form","",3,"formGroup","ngSubmit"],["nzFor","farmerName","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your name!",3,"nzSm","nzXs"],["nz-input","","id","farmerName","formControlName","name","placeholder","Name","autocomplete","off"],["nzFor","phoneNumber",3,"nzSm","nzXs"],["nzErrorTip","Please input your phone number!",3,"nzSm","nzXs","nzValidateStatus"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","phoneNumber","id","'phoneNumber'","nz-input","","autocomplete","off",3,"maxlength"],["nzFor","address",3,"nzSm","nzXs"],["nzErrorTip","Please input your address!",3,"nzSm","nzXs","nzValidateStatus"],[1,"ant-input-affix-wrapper-textarea-with-clear-btn",3,"nzSuffix"],["nz-input","","formControlName","address","placeholder","Address"],["textAreaClearTpl",""],["nzFor","notes",3,"nzSm","nzXs"],["nzErrorTip","Please input your notes!",3,"nzSm","nzXs","nzValidateStatus"],["nz-input","","formControlName","notes","placeholder","Notes"],["textAreaClearNotes",""],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"disabled"],["nz-button","","nzType","default",3,"click"],["nz-tooltip","","nzTooltipTitle","Export as Excel",3,"click"],["nz-icon","","nzType","file-excel","nzTheme","fill"],[3,"nzData","nzShowPagination","nzLoading",4,"ngIf"],[1,"text-right"],[3,"nzPageIndex","nzTotal","nzShowSizeChanger","nzPageSize","nzPageIndexChange","nzPageSizeChange"],["nzShowSearch","","nzAllowClear","","nzDisabled","","formControlName","phoneNumberPrefix",1,"phone-select"],["nzLabel","+91","nzValue","+91"],["nz-icon","","class","ant-input-clear-icon","nzTheme","fill","nzType","close-circle",3,"click",4,"ngIf"],["nz-icon","","nzTheme","fill","nzType","close-circle",1,"ant-input-clear-icon",3,"click"],[3,"nzData","nzShowPagination","nzLoading"],["basicTable",""],[4,"ngFor","ngForOf"],[3,"click"],["nz-icon","","nzType","edit","nzTheme","fill"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this Farmer","nzPopconfirmPlacement","bottom",3,"nzOnConfirm","nzOnCancel"],["nz-icon","","nzType","delete","nzTheme","fill"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),e._uU(4,"Farmers"),e.qZA()()(),e.TgZ(5,"div",1)(6,"div",4)(7,"form",5),e.NdJ("ngSubmit",function(){return t.submitForm()}),e.TgZ(8,"nz-form-item")(9,"nz-form-label",6)(10,"span"),e._uU(11,"Name"),e.qZA()(),e.TgZ(12,"nz-form-control",7),e._UZ(13,"input",8),e.qZA()(),e.TgZ(14,"nz-form-item")(15,"nz-form-label",9),e._uU(16,"Phone Number"),e.qZA(),e.TgZ(17,"nz-form-control",10)(18,"nz-input-group",11),e.YNc(19,y,2,0,"ng-template",null,12,e.W1O),e._UZ(21,"input",13),e.qZA()()(),e.TgZ(22,"nz-form-item")(23,"nz-form-label",14),e._uU(24,"Address"),e.qZA(),e.TgZ(25,"nz-form-control",15)(26,"nz-input-group",16),e._UZ(27,"textarea",17),e.qZA(),e.YNc(28,O,1,1,"ng-template",null,18,e.W1O),e.qZA()(),e.TgZ(30,"nz-form-item")(31,"nz-form-label",19),e._uU(32,"Notes"),e.qZA(),e.TgZ(33,"nz-form-control",20)(34,"nz-input-group",16),e._UZ(35,"textarea",21),e.qZA(),e.YNc(36,E,1,1,"ng-template",null,22,e.W1O),e.qZA()(),e.TgZ(38,"nz-form-item",23)(39,"nz-form-control",24)(40,"button",25),e._uU(41),e.qZA(),e._uU(42,"\xa0 "),e.TgZ(43,"button",26),e.NdJ("click",function(){return t.reset()}),e._uU(44,"Reset"),e.qZA()()()()(),e.TgZ(45,"div",4)(46,"div")(47,"a",27),e.NdJ("click",function(){return t.exportToExcel()}),e._UZ(48,"span",28),e.qZA()(),e.YNc(49,M,16,4,"nz-table",29),e.TgZ(50,"div",30),e._UZ(51,"br"),e.TgZ(52,"nz-pagination",31),e.NdJ("nzPageIndexChange",function(s){return t.onPageChange(s)})("nzPageSizeChange",function(s){return t.onPageSizeChange(s)}),e.qZA(),e._UZ(53,"br"),e.qZA()()()()),2&n){const o=e.MAs(20),s=e.MAs(29),l=e.MAs(37);e.xp6(7),e.Q6J("formGroup",t.validateForm),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.phoneNumber),e.xp6(1),e.Q6J("nzAddOnBefore",o),e.xp6(3),e.Q6J("maxlength",10),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.address),e.xp6(1),e.Q6J("nzSuffix",s),e.xp6(5),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.notes),e.xp6(1),e.Q6J("nzSuffix",l),e.xp6(5),e.Q6J("nzSpan",14)("nzOffset",6),e.xp6(1),e.Q6J("disabled",!t.validateForm.valid),e.xp6(1),e.Oqu(t.edit?"Update":"Create"),e.xp6(8),e.Q6J("ngIf",t.farmersData),e.xp6(3),e.Q6J("nzPageIndex",t.index)("nzTotal",t.total)("nzShowSizeChanger",!0)("nzPageSize",t.pageSize)}},dependencies:[u.sg,u.O5,S.SY,Z.Ls,f.t3,f.SK,p.Lr,p.Nx,p.iK,p.Fd,m._Y,m.Fj,m.JJ,m.JL,m.nD,m.sg,m.u,z.Zp,z.gB,z.ke,_.Ip,_.Vq,C.ix,A.w,N.dQ,c.N8,c.Uo,c._C,c.Om,c.p0,c.$Z,b.JW,P.dE],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}"]}),r})()}];let B=(()=>{class r{}return r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[g.Bz.forChild(q),g.Bz]}),r})();var D=a(9912);let Y=(()=>{class r{}return r.\u0275fac=function(n){return new(n||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.ez,B,D.m]}),r})()}}]);