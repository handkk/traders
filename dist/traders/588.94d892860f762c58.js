"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[588],{588:(q,u,r)=>{r.r(u),r.d(u,{BillPrintModule:()=>M});var c=r(6895),p=r(4575),m=r(5439),t=r(4650),_=r(2566),h=r(433),b=r(5259),Z=r(1949);function f(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",14),t._uU(8),t.qZA(),t.TgZ(9,"td",14),t._uU(10),t.qZA()()),2&i){const n=l.$implicit;t.xp6(2),t.Oqu(n.vegetable_name),t.xp6(2),t.Oqu(n.notes),t.xp6(2),t.Oqu(n.quantity),t.xp6(2),t.Oqu(n.rate),t.xp6(2),t.Oqu(n.total_amount)}}function C(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t._UZ(6,"td")(7,"td")(8,"td"),t.qZA()),2&i){const n=l.$implicit;t.xp6(2),t.Oqu(t.xi3(3,2,n.collection_date,"dd/MM/yyyy")),t.xp6(3),t.Oqu(n.amount)}}function y(i,l){if(1&i&&(t.TgZ(0,"div",4)(1,"table",5)(2,"tr")(3,"td",6)(4,"span",7),t._uU(5,"Sri Sainath Traders"),t.qZA(),t._uU(6," (9640443322) "),t.qZA()(),t.TgZ(7,"tr")(8,"td",8),t._uU(9),t.qZA(),t.TgZ(10,"td",9)(11,"span"),t._uU(12),t.qZA(),t._uU(13),t.qZA()(),t.TgZ(14,"tr")(15,"td",10),t._UZ(16,"hr",11),t.qZA()(),t.YNc(17,f,11,5,"tr",12),t.TgZ(18,"tr"),t._UZ(19,"td")(20,"td")(21,"td")(22,"td"),t.TgZ(23,"td"),t._UZ(24,"hr",11),t.qZA()(),t.TgZ(25,"tr")(26,"td",13),t._uU(27,"Last 2 Collections"),t.qZA(),t._UZ(28,"td")(29,"td")(30,"td"),t.TgZ(31,"td",14),t._uU(32),t.qZA()(),t.YNc(33,C,9,5,"tr",12),t.TgZ(34,"tr"),t._UZ(35,"td")(36,"td")(37,"td")(38,"td")(39,"td"),t.qZA(),t.TgZ(40,"tr"),t._UZ(41,"td")(42,"td")(43,"td")(44,"td"),t.TgZ(45,"td"),t._UZ(46,"hr",11),t.qZA()(),t.TgZ(47,"tr"),t._UZ(48,"td")(49,"td")(50,"td")(51,"td"),t.TgZ(52,"td",14),t._uU(53),t.qZA(),t._UZ(54,"td"),t.qZA(),t.TgZ(55,"tr"),t._UZ(56,"td")(57,"td")(58,"td")(59,"td"),t.TgZ(60,"td"),t._UZ(61,"hr",11),t.qZA()(),t.TgZ(62,"tr"),t._UZ(63,"td")(64,"td")(65,"td")(66,"td"),t.TgZ(67,"td",14),t._uU(68),t.qZA()()()()),2&i){const n=l.$implicit,e=t.oxw();t.xp6(9),t.Oqu(n.name),t.xp6(3),t.Oqu(0===e.day?"Sun,":1===e.day?"Mon,":2===e.day?"Tue,":3===e.day?"Wed,":4===e.day?"Thu,":5===e.day?"Fri,":6===e.day?"Sat,":""),t.xp6(1),t.hij(" ",e.todayDate," "),t.xp6(4),t.Q6J("ngForOf",n.bills),t.xp6(15),t.Oqu(n.bill_amount),t.xp6(1),t.Q6J("ngForOf",n.collections),t.xp6(20),t.Oqu(n.balance),t.xp6(15),t.Oqu(n.total_bill)}}const x=[{path:"",component:(()=>{class i{constructor(n){this.mainService=n,this.isVisible=!1,this.todayDate="",this.day=0,this.tablestring="",this.printData=[],this.collectionsData=[],this.date=new Date}ngOnInit(){const n=new Date;this.day=n.getDay(),this.todayDate=m(n).format("DD-MM-YYYY"),this.getCollections()}showModal(){this.isVisible=!0}handleOk(){this.isVisible=!1}handleCancel(){this.isVisible=!1}print(){window.open()}getbalance_statement(){this.mainService.get_balance_statement({}).subscribe(e=>{e.table&&(this.tablestring=e.table)},e=>{console.log("get customers err ",e)})}getCollectionsByCustomerId(n){this.mainService.getCollectionsByCustomerId(n).subscribe(e=>{let s=[];e&&e.length>0&&(s.push(e[0]),s.push(e[1])),this.printData.forEach(a=>{a.cusomer_id===n&&(a.collections=s)})},e=>(console.log("get customers err ",e),e))}printCustomerBills(){const s={skip:0,limit:1e3,bill_date:m(this.date).format("YYYY-MM-DD")};this.mainService.spinning.emit(!0),this.mainService.printCustomerBills(s).subscribe(a=>{let g;a.forEach(o=>{o.balance=o.collected_amount-o.last_amount_updated,o.bill_amount=0,o.bills.forEach(d=>{o.bill_amount=o.bill_amount+d.total_amount}),o.total_bill=o.bill_amount-o.balance,o.collections=[],this.collectionsData.forEach(d=>{o.cusomer_id===d.customer_id&&o.collections.length<2&&o.collections.push(d)})}),g=a,g&&(this.printData=g),this.mainService.spinning.emit(!1)},a=>{console.log("get customers err ",a),this.mainService.spinning.emit(!1)})}getCollections(){this.mainService.getCollections({}).subscribe(e=>{this.collectionsData=e.data,this.printCustomerBills()},e=>{console.log("get customers err ",e),this.collectionsData=[]})}onChange(n){this.printCustomerBills()}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(_.J))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bill-print"]],decls:7,vars:3,consts:[[1,"header-print"],[3,"ngModel","nzAllowClear","ngModelChange"],[1,"container"],["class","bill",4,"ngFor","ngForOf"],[1,"bill"],[2,"width","100%"],["colspan","5",1,"text-center"],[1,"shop-title"],["colspan","4"],[2,"text-align","right"],["colspan","5",2,"width","100%"],[2,"border","1px dashed #000"],[4,"ngFor","ngForOf"],[2,"text-decoration","underline"],[1,"number"]],template:function(n,e){1&n&&(t.TgZ(0,"h2",0),t._uU(1,"Bill Print"),t.qZA(),t._UZ(2,"br"),t.TgZ(3,"nz-date-picker",1),t.NdJ("ngModelChange",function(a){return e.date=a})("ngModelChange",function(a){return e.onChange(a)}),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"div",2),t.YNc(6,y,69,8,"div",3),t.qZA()),2&n&&(t.xp6(3),t.Q6J("ngModel",e.date)("nzAllowClear",!1),t.xp6(3),t.Q6J("ngForOf",e.printData))},dependencies:[c.sg,h.JJ,h.On,b.uw,Z.Uo,Z.$Z,c.uU],styles:[".shop-title[_ngcontent-%COMP%]{color:#06f706}.print-box-width[_ngcontent-%COMP%]{width:386px;height:365px}body[_ngcontent-%COMP%]{margin:0;padding:0}.container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,2fr);grid-gap:20px;margin:20px}.bill[_ngcontent-%COMP%]{width:100%;height:100%;border:1px solid #000;padding:10px;box-sizing:border-box;page-break-inside:avoid}.number[_ngcontent-%COMP%]{text-align:right!important}@page{size:A4;margin:0}@media print{body[_ngcontent-%COMP%]{margin:.5cm}.container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,2fr);grid-gap:20px;margin:0}.bill[_ngcontent-%COMP%]{width:100%;height:100%;border:1px solid #000;padding:10px;box-sizing:border-box;page-break-inside:avoid}.header-print[_ngcontent-%COMP%]{display:none}}h2[_ngcontent-%COMP%]{text-align:center}"]}),i})()}];let T=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.Bz.forChild(x),p.Bz]}),i})();var U=r(9912);let M=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.ez,U.m,T]}),i})()}}]);