"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[620],{8620:(G,h,i)=>{i.r(h),i.d(h,{DayCollectionsModule:()=>Y});var m=i(6895),u=i(2564),r=i(433),z=i(5439),y=i(6166),_=i(4159),Z=i.n(_),n=i(4650),v=i(9651),T=i(2566),D=i(1102),p=i(3679),c=i(6704),C=i(8231),O=i(6616),P=i(7044),x=i(1811),S=i(5259),g=i(7635),M=i(1634);const b=["dayBillTable"];function A(o,l){if(1&o&&n._UZ(0,"nz-option",26),2&o){const t=l.$implicit;n.Q6J("nzLabel",t.name)("nzValue",t)}}function B(o,l){if(1&o){const t=n.EpF();n.TgZ(0,"a",27),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.downloadPDF())}),n._UZ(1,"span",28),n.qZA()}}function F(o,l){if(1&o){const t=n.EpF();n.TgZ(0,"a",29),n.NdJ("click",function(){n.CHM(t);const a=n.oxw();return n.KtG(a.printTable())}),n._UZ(1,"span",30),n.qZA()}}function U(o,l){if(1&o&&(n.TgZ(0,"tr",32)(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td"),n._uU(4),n.qZA(),n.TgZ(5,"td"),n._uU(6),n.qZA(),n._UZ(7,"td"),n.qZA()),2&o){const t=l.$implicit;n.xp6(2),n.Oqu(t.customer_name),n.xp6(2),n.Oqu(t.total_amount),n.xp6(2),n.Oqu(t.customer_balance_amount)}}function J(o,l){if(1&o&&(n.TgZ(0,"table",31)(1,"tr",32)(2,"th"),n._uU(3,"Customer Name"),n.qZA(),n.TgZ(4,"th"),n._uU(5,"Today Bill"),n.qZA(),n.TgZ(6,"th"),n._uU(7,"Balance"),n.qZA(),n.TgZ(8,"th"),n._uU(9,"Paid"),n.qZA()(),n.YNc(10,U,8,3,"tr",33),n.qZA()),2&o){const t=n.oxw();n.xp6(10),n.Q6J("ngForOf",t.dayBillsList)}}function q(o,l){1&o&&(n.TgZ(0,"h3",3),n._uU(1,"No Bills"),n.qZA())}function L(o,l){if(1&o&&(n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td"),n._uU(4),n.qZA(),n.TgZ(5,"td"),n._uU(6,"0 "),n.qZA(),n._UZ(7,"td"),n.qZA()),2&o){const t=l.$implicit;n.xp6(2),n.Oqu(t.customer_name),n.xp6(2),n.Oqu(t.total_amount)}}const N=[{path:"",component:(()=>{class o{constructor(t,e,a,s,d){this.fb=t,this.el=e,this.message=a,this.mainService=s,this.router=d,this.customers=[],this.vegetablesList=[],this.farmersList=[],this.date=new Date,this.defaultDate=new Date,this.collectionsData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name",sortOrder:"ascend"},{item:"Item",sortOrder:null},{rate:"Rate",sortOrder:null},{quantity:"quantity",sortOrder:null}],this.index=1,this.total=0,this.pageSize=10,this.loading=!1,this.dayBillsList=[],sessionStorage.getItem("userinfo")||(sessionStorage.clear(),this.message.create("warning","User session expired please login"),this.router.navigateByUrl("/login"))}ngOnInit(){this.dayCollectionForm=this.fb.group({customer:[null],date:[this.date,[r.kI.required]]}),this.getCustomers()}downloadPDF(){Z()(this.dayBillTable.nativeElement,{}).then(t=>{const e=t.toDataURL("image/png");console.log("imageData: ",e);const d=208*t.height/t.width,f=new y.default("p","mm","a4");f.addImage(e,"PNG",0,0,208,d),f.save("today_bills.pdf")})}getDayCollections(){let t;t={skip:this.index,limit:this.pageSize},this.loading=!0,t.bill_date="2023-09-22",this.mainService.getDayBills(t).subscribe(e=>{console.log("getDayBills data: ",e),this.loading=!1},e=>{console.log("get customers err ",e),this.collectionsData=[],this.loading=!1})}getCustomers(){this.mainService.getCustomers({}).subscribe(e=>{this.customers=e.data},e=>{console.log("get customers err ",e),this.customers=[]})}clearfield(t){this.dayCollectionForm.controls[t].reset()}submitForm(){if(this.dayCollectionForm.valid){let e={bill_date:z(this.dayCollectionForm.value.date).format("YYYY-MM-DD")};console.log("this.dayCollectionForm.value.customer === ",this.dayCollectionForm.value.customer),this.dayCollectionForm.value.customer&&(e.customer_name=this.dayCollectionForm.value.customer.name,e.customer_id=this.dayCollectionForm.value.customer._id),console.log("requestBody: ",e),this.mainService.getDayBills(e).subscribe(a=>{console.log("getDayBills data: === ",a),this.dayBillsList=a,this.loading=!1},a=>{console.log("get customers err ",a),this.loading=!1})}else Object.values(this.dayCollectionForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}reset(){this.dayCollectionForm.controls.amount.reset(),this.dayCollectionForm.controls.notes.reset()}onChange(t){}deleteConfirm(t){this.loading=!0,this.mainService.removeCollection(t).subscribe(e=>{this.loading=!1,e&&e.success&&this.message.create("success",e.message)},e=>{console.log("get customers err ",e),this.loading=!1})}cancel(){}onPageSizeChange(t){this.pageSize=t}onPageChange(t){this.index=t}printTable(){window.print()}}return o.\u0275fac=function(t){return new(t||o)(n.Y36(r.QS),n.Y36(n.SBq),n.Y36(v.dD),n.Y36(T.J),n.Y36(u.F0))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-day-collections"]],viewQuery:function(t,e){if(1&t&&n.Gf(b,5),2&t){let a;n.iGM(a=n.CRH())&&(e.dayBillTable=a.first)}},decls:54,vars:26,consts:[[1,"customer-form"],["nz-row","",1,"page-header1"],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-row","",1,"page-header2"],["nz-form","","appFocus","",3,"formGroup","ngSubmit"],["nz-row",""],["nz-col","","nzSpan","8"],["nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["formControlName","date",3,"ngModel","nzAllowClear","ngModelChange"],["nzShowSearch","","nzAllowClear","","formControlName","customer","id","collectionCustomerInput"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary"],["class","align-right margin-right25",3,"click",4,"ngIf"],["class","align-right margin-right10",3,"click",4,"ngIf"],[1,"print-container"],["dayBillTable",""],["style","width: 100%;",4,"ngIf"],["class","text-center",4,"ngIf"],[2,"display","none",3,"nzData","nzLoading","nzShowPagination"],[4,"ngFor","ngForOf"],[1,"text-right"],[3,"nzPageIndex","nzTotal","nzShowSizeChanger","nzPageSize","nzPageIndexChange","nzPageSizeChange"],[3,"nzLabel","nzValue"],[1,"align-right","margin-right25",3,"click"],["nz-icon","","nzType","file-pdf","nzTheme","fill"],[1,"align-right","margin-right10",3,"click"],["nz-icon","","nzType","printer","nzTheme","fill"],[2,"width","100%"],[2,"text-align","left"],["style","text-align: left;",4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),n._uU(4,"Day-wise Bills"),n.qZA()()(),n.TgZ(5,"div",4)(6,"div",2)(7,"form",5),n.NdJ("ngSubmit",function(){return e.submitForm()}),n.TgZ(8,"div",6)(9,"div",7)(10,"nz-form-item")(11,"nz-form-label",8),n._uU(12,"Date"),n.qZA(),n.TgZ(13,"nz-form-control",9)(14,"nz-date-picker",10),n.NdJ("ngModelChange",function(s){return e.date=s})("ngModelChange",function(s){return e.onChange(s)}),n.qZA()()()(),n.TgZ(15,"div",7)(16,"nz-form-item")(17,"nz-form-label",9)(18,"span"),n._uU(19,"Customer"),n.qZA()(),n.TgZ(20,"nz-form-control",9)(21,"nz-select",11),n.YNc(22,A,1,2,"nz-option",12),n.qZA()()()(),n.TgZ(23,"div",7)(24,"nz-form-item",13)(25,"nz-form-control",14)(26,"button",15),n._uU(27,"Submit"),n.qZA(),n._uU(28,"\xa0 "),n.qZA()()()()()()(),n.TgZ(29,"div",6)(30,"div",2),n.YNc(31,B,2,0,"a",16),n.YNc(32,F,2,0,"a",17),n.TgZ(33,"div",18,19),n.YNc(35,J,11,1,"table",20),n.YNc(36,q,2,0,"h3",21),n.qZA(),n.TgZ(37,"nz-table",22)(38,"thead")(39,"tr")(40,"th"),n._uU(41,"Customer Name"),n.qZA(),n.TgZ(42,"th"),n._uU(43,"Today Bill"),n.qZA(),n.TgZ(44,"th"),n._uU(45,"Balance"),n.qZA(),n.TgZ(46,"th"),n._uU(47,"Paid"),n.qZA()()(),n.TgZ(48,"tbody"),n.YNc(49,L,8,2,"tr",23),n.qZA()(),n.TgZ(50,"div",24),n._UZ(51,"br"),n.TgZ(52,"nz-pagination",25),n.NdJ("nzPageIndexChange",function(s){return e.onPageChange(s)})("nzPageSizeChange",function(s){return e.onPageSizeChange(s)}),n.qZA(),n._UZ(53,"br"),n.qZA()()()()),2&t&&(n.xp6(7),n.Q6J("formGroup",e.dayCollectionForm),n.xp6(4),n.Q6J("nzSm",6)("nzXs",24),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("ngModel",e.date)("nzAllowClear",!1),n.xp6(3),n.Q6J("nzSm",6)("nzXs",24),n.xp6(3),n.Q6J("nzSm",14)("nzXs",24),n.xp6(2),n.Q6J("ngForOf",e.customers),n.xp6(3),n.Q6J("nzSpan",14)("nzOffset",6),n.xp6(6),n.Q6J("ngIf",e.dayBillsList&&e.dayBillsList.length>0),n.xp6(1),n.Q6J("ngIf",e.dayBillsList&&e.dayBillsList.length>0),n.xp6(3),n.Q6J("ngIf",e.dayBillsList&&e.dayBillsList.length>0),n.xp6(1),n.Q6J("ngIf",0===e.dayBillsList.length),n.xp6(1),n.Q6J("nzData",e.dayBillsList)("nzLoading",e.loading)("nzShowPagination",!1),n.xp6(12),n.Q6J("ngForOf",e.dayBillsList),n.xp6(3),n.Q6J("nzPageIndex",e.index)("nzTotal",e.total)("nzShowSizeChanger",!0)("nzPageSize",e.pageSize))},dependencies:[m.sg,m.O5,D.Ls,p.t3,p.SK,c.Lr,c.Nx,c.iK,c.Fd,r._Y,r.JJ,r.JL,r.sg,r.u,C.Ip,C.Vq,O.ix,P.w,x.dQ,S.uw,g.N8,g.Uo,g._C,g.Om,g.p0,g.$Z,M.dE],styles:[".margin-right10[_ngcontent-%COMP%]{margin-right:10px}.margin-right20[_ngcontent-%COMP%]{margin-right:20px}.margin-right25[_ngcontent-%COMP%]{margin-right:25px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}nz-date-picker[_ngcontent-%COMP%]{margin:0 8px 12px 0}input[type=number][_ngcontent-%COMP%]{border:1px solid #d9d9d9!important}input[type=number][_ngcontent-%COMP%]:focus{border:1px solid #40a9ff!important}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}.print-container[_ngcontent-%COMP%]{padding:25px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #000;padding:10px;background-color:#d3d3d3}td[_ngcontent-%COMP%]{border:1px solid #000;padding:10px}.align-right[_ngcontent-%COMP%]{float:right}@media print{body[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}.print-container[_ngcontent-%COMP%], .print-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:visible}.page-header1[_ngcontent-%COMP%], .page-header2[_ngcontent-%COMP%], button[_ngcontent-%COMP%], .ant-menu[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{display:none}}"]}),o})()}];let Q=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[u.Bz.forChild(N),u.Bz]}),o})();var I=i(4973);let Y=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[m.ez,Q,I.m]}),o})()}}]);