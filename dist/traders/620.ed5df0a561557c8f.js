"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[620],{8620:(b,m,s)=>{s.r(m),s.d(m,{DayCollectionsModule:()=>O});var d=s(6895),u=s(2564),l=s(433),h=s(5439),t=s(4650),p=s(9651),z=s(2566),g=s(3679),c=s(6704),C=s(8231),f=s(6616),y=s(7044),v=s(1811),S=s(5259);function D(n,i){if(1&n&&t._UZ(0,"nz-option",14),2&n){const o=i.$implicit;t.Q6J("nzLabel",o.name)("nzValue",o)}}const M=[{path:"",component:(()=>{class n{constructor(o,e,r,a){this.fb=o,this.el=e,this.message=r,this.mainService=a,this.customers=[],this.vegetablesList=[],this.farmersList=[],this.date=new Date,this.defaultDate=new Date,this.collectionsData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name",sortOrder:"ascend"},{item:"Item",sortOrder:null},{rate:"Rate",sortOrder:null},{quantity:"quantity",sortOrder:null}],this.index=1,this.total=0,this.pageSize=10,this.loading=!1}ngOnInit(){this.dayCollectionForm=this.fb.group({customer:[null,[l.kI.required]],date:[this.date,[l.kI.required]]}),this.getCustomers()}getCollections(){const o={skip:this.index,limit:this.pageSize};this.loading=!0,this.mainService.getCollections(o).subscribe(e=>{this.collectionsData=e.data,this.total=e.total,this.loading=!1},e=>{console.log("get customers err ",e),this.collectionsData=[],this.loading=!1})}getCustomers(){this.mainService.getCustomers({}).subscribe(e=>{this.customers=e.data},e=>{console.log("get customers err ",e),this.customers=[]})}clearfield(o){this.dayCollectionForm.controls[o].reset()}submitForm(){if(this.dayCollectionForm.valid){const o=h(this.dayCollectionForm.value.date).format("YYYY-MM-DDTHH:mm:ss.000");console.log("requestBody: ",{customer_name:this.dayCollectionForm.value.customer.name,customer_id:this.dayCollectionForm.value.customer._id,collection_date:o})}else Object.values(this.dayCollectionForm.controls).forEach(o=>{o.invalid&&(o.markAsDirty(),o.updateValueAndValidity({onlySelf:!0}))})}reset(){this.dayCollectionForm.controls.amount.reset(),this.dayCollectionForm.controls.notes.reset()}onChange(o){}deleteConfirm(o){this.loading=!0,this.mainService.removeCollection(o).subscribe(e=>{this.loading=!1,e&&e.success&&(this.message.create("success",e.message),this.getCollections())},e=>{console.log("get customers err ",e),this.loading=!1})}cancel(){}onPageSizeChange(o){this.pageSize=o,this.getCollections()}onPageChange(o){this.index=o,this.getCollections()}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(l.QS),t.Y36(t.SBq),t.Y36(p.dD),t.Y36(z.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-day-collections"]],decls:29,vars:14,consts:[[1,"customer-form"],["nz-row",""],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-form","","appFocus","",3,"formGroup","ngSubmit"],["nz-col","","nzSpan","8"],["nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["formControlName","date",3,"ngModel","nzAllowClear","ngModelChange"],["nzShowSearch","","nzAllowClear","","formControlName","customer","id","collectionCustomerInput"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary","disabled","true"],[3,"nzLabel","nzValue"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Customer Collections"),t.qZA()()(),t.TgZ(5,"div",1)(6,"div",2)(7,"form",4),t.NdJ("ngSubmit",function(){return e.submitForm()}),t.TgZ(8,"div",1)(9,"div",5)(10,"nz-form-item")(11,"nz-form-label",6),t._uU(12,"Date"),t.qZA(),t.TgZ(13,"nz-form-control",7)(14,"nz-date-picker",8),t.NdJ("ngModelChange",function(a){return e.date=a})("ngModelChange",function(a){return e.onChange(a)}),t.qZA()()()(),t.TgZ(15,"div",5)(16,"nz-form-item")(17,"nz-form-label",6)(18,"span"),t._uU(19,"Customer"),t.qZA()(),t.TgZ(20,"nz-form-control",7)(21,"nz-select",9),t.YNc(22,D,1,2,"nz-option",10),t.qZA()()()(),t.TgZ(23,"div",5)(24,"nz-form-item",11)(25,"nz-form-control",12)(26,"button",13),t._uU(27,"Submit"),t.qZA(),t._uU(28,"\xa0 "),t.qZA()()()()()()()()),2&o&&(t.xp6(7),t.Q6J("formGroup",e.dayCollectionForm),t.xp6(4),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24),t.xp6(1),t.Q6J("ngModel",e.date)("nzAllowClear",!1),t.xp6(3),t.Q6J("nzSm",6)("nzXs",24),t.xp6(3),t.Q6J("nzSm",14)("nzXs",24),t.xp6(2),t.Q6J("ngForOf",e.customers),t.xp6(3),t.Q6J("nzSpan",14)("nzOffset",6))},dependencies:[d.sg,g.t3,g.SK,c.Lr,c.Nx,c.iK,c.Fd,l._Y,l.JJ,l.JL,l.sg,l.u,C.Ip,C.Vq,f.ix,y.w,v.dQ,S.uw],styles:[".phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}nz-date-picker[_ngcontent-%COMP%]{margin:0 8px 12px 0}input[type=number][_ngcontent-%COMP%]{border:1px solid #d9d9d9!important}input[type=number][_ngcontent-%COMP%]:focus{border:1px solid #40a9ff!important}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}"]}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.Bz.forChild(M),u.Bz]}),n})();var x=s(4973);let O=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,F,x.m]}),n})()}}]);