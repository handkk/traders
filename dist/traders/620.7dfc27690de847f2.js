"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[620],{8620:(Y,p,a)=>{a.r(p),a.d(p,{DayCollectionsModule:()=>Q});var m=a(6895),h=a(4575),g=a(433),y=a(5439),z=a(6166),_=a(4159),Z=a.n(_),t=a(4650),v=a(9651),T=a(2566),D=a(1102),C=a(3679),c=a(6704),P=a(6616),O=a(7044),M=a(1811),S=a(5259),d=a(1949),x=a(1634);const b=["dayBillTable"];function B(o,l){if(1&o){const n=t.EpF();t.TgZ(0,"a",24),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.downloadPDF())}),t._UZ(1,"span",25),t.qZA()}}function A(o,l){if(1&o){const n=t.EpF();t.TgZ(0,"a",26),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.printTable())}),t._UZ(1,"span",27),t.qZA()}}function U(o,l){if(1&o&&(t.TgZ(0,"tr",29)(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t._UZ(7,"td"),t.qZA()),2&o){const n=l.$implicit;t.xp6(2),t.Oqu(n.name),t.xp6(2),t.Oqu(n.total_amount),t.xp6(2),t.Oqu(n.balance_amount)}}function F(o,l){if(1&o&&(t.TgZ(0,"table",28)(1,"tr",29)(2,"th"),t._uU(3,"Customer Name"),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Today Bill"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Balance"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Paid"),t.qZA()(),t.YNc(10,U,8,3,"tr",30),t.qZA()),2&o){const n=t.oxw();t.xp6(10),t.Q6J("ngForOf",n.dayBillsList)}}function J(o,l){1&o&&(t.TgZ(0,"h3",3),t._uU(1,"No Bills"),t.qZA())}function q(o,l){if(1&o&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6,"0 "),t.qZA(),t._UZ(7,"td"),t.qZA()),2&o){const n=l.$implicit;t.xp6(2),t.Oqu(n.customer_name),t.xp6(2),t.Oqu(n.total_amount)}}const L=[{path:"",component:(()=>{class o{constructor(n,e,i,s,r){this.fb=n,this.el=e,this.message=i,this.mainService=s,this.router=r,this.customers=[],this.vegetablesList=[],this.farmersList=[],this.date=new Date,this.defaultDate=new Date,this.collectionsData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name",sortOrder:"ascend"},{item:"Item",sortOrder:null},{rate:"Rate",sortOrder:null},{quantity:"quantity",sortOrder:null}],this.index=1,this.total=0,this.pageSize=10,this.loading=!1,this.dayBillsList=[],sessionStorage.getItem("userinfo")||(sessionStorage.clear(),this.message.create("warning","User session expired please login"),this.router.navigateByUrl("/login"))}ngOnInit(){this.dayCollectionForm=this.fb.group({customer:[null],date:[this.date,[g.kI.required]]}),this.getCustomers()}downloadPDF(){Z()(this.dayBillTable.nativeElement,{}).then(n=>{const e=n.toDataURL("image/png");console.log("imageData: ",e);const r=208*n.height/n.width,f=new z.default("p","mm","a4");f.addImage(e,"PNG",0,0,208,r),f.save("today_bills.pdf")})}getDayCollections(){let n;n={skip:this.index,limit:this.pageSize},this.loading=!0,n.bill_date="2023-09-22",this.mainService.getDayBills(n).subscribe(e=>{console.log("getDayBills data: ",e),this.loading=!1},e=>{console.log("get customers err ",e),this.collectionsData=[],this.loading=!1})}getCustomers(){this.mainService.getCustomers({}).subscribe(e=>{this.customers=e.data},e=>{console.log("get customers err ",e),this.customers=[]})}clearfield(n){this.dayCollectionForm.controls[n].reset()}submitForm(){if(this.dayCollectionForm.valid){let e={skip:0,limit:1e3,bill_date:y(this.dayCollectionForm.value.date).format("YYYY-MM-DD")};console.log("requestBody: ",e),this.mainService.spinning.emit(!0),this.mainService.printCustomerBills(e).subscribe(i=>{if(console.log("getDayBills data: === ",i),this.dayBillsList=[],this.mainService.spinning.emit(!1),i&&i.length>0){let s=i;s.forEach(r=>{r.total_amount=0,r.bills.forEach(u=>{r.total_amount=r.total_amount+u.total_amount})}),this.dayBillsList=s}},i=>{console.log("get customers err ",i),this.loading=!1,this.mainService.spinning.emit(!1)})}else Object.values(this.dayCollectionForm.controls).forEach(n=>{n.invalid&&(n.markAsDirty(),n.updateValueAndValidity({onlySelf:!0}))})}reset(){this.dayCollectionForm.controls.amount.reset(),this.dayCollectionForm.controls.notes.reset()}onChange(n){}deleteConfirm(n){this.loading=!0,this.mainService.removeCollection(n).subscribe(e=>{this.loading=!1,e&&e.success&&this.message.create("success",e.message)},e=>{console.log("get customers err ",e),this.loading=!1})}cancel(){}onPageSizeChange(n){this.pageSize=n}onPageChange(n){this.index=n}printTable(){window.print()}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(g.QS),t.Y36(t.SBq),t.Y36(v.dD),t.Y36(T.J),t.Y36(h.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-day-collections"]],viewQuery:function(n,e){if(1&n&&t.Gf(b,5),2&n){let i;t.iGM(i=t.CRH())&&(e.dayBillTable=i.first)}},decls:46,vars:21,consts:[[1,"customer-form"],["nz-row","",1,"page-header1"],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-row","",1,"page-header2"],["nz-form","","appFocus","",3,"formGroup","ngSubmit"],["nz-row",""],["nz-col","","nzSpan","8"],["nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["formControlName","date",3,"ngModel","nzAllowClear","ngModelChange"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary"],["class","align-right margin-right25",3,"click",4,"ngIf"],["class","align-right margin-right10",3,"click",4,"ngIf"],[1,"print-container"],["dayBillTable",""],["style","width: 100%;",4,"ngIf"],["class","text-center",4,"ngIf"],[2,"display","none",3,"nzData","nzLoading","nzShowPagination"],[4,"ngFor","ngForOf"],[1,"text-right"],[3,"nzPageIndex","nzTotal","nzShowSizeChanger","nzPageSize","nzPageIndexChange","nzPageSizeChange"],[1,"align-right","margin-right25",3,"click"],["nz-icon","","nzType","file-pdf","nzTheme","fill"],[1,"align-right","margin-right10",3,"click"],["nz-icon","","nzType","printer","nzTheme","fill"],[2,"width","100%"],[2,"text-align","left"],["style","text-align: left;",4,"ngFor","ngForOf"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4,"Day-wise Bills"),t.qZA()()(),t.TgZ(5,"div",4)(6,"div",2)(7,"form",5),t.NdJ("ngSubmit",function(){return e.submitForm()}),t.TgZ(8,"div",6)(9,"div",7)(10,"nz-form-item")(11,"nz-form-label",8),t._uU(12,"Date"),t.qZA(),t.TgZ(13,"nz-form-control",9)(14,"nz-date-picker",10),t.NdJ("ngModelChange",function(s){return e.date=s})("ngModelChange",function(s){return e.onChange(s)}),t.qZA()()()(),t.TgZ(15,"div",7)(16,"nz-form-item",11)(17,"nz-form-control",12)(18,"button",13),t._uU(19,"Submit"),t.qZA(),t._uU(20,"\xa0 "),t.qZA()()()()()()(),t.TgZ(21,"div",6)(22,"div",2),t.YNc(23,B,2,0,"a",14),t.YNc(24,A,2,0,"a",15),t.TgZ(25,"div",16,17),t.YNc(27,F,11,1,"table",18),t.YNc(28,J,2,0,"h3",19),t.qZA(),t.TgZ(29,"nz-table",20)(30,"thead")(31,"tr")(32,"th"),t._uU(33,"Customer Name"),t.qZA(),t.TgZ(34,"th"),t._uU(35,"Today Bill"),t.qZA(),t.TgZ(36,"th"),t._uU(37,"Balance"),t.qZA(),t.TgZ(38,"th"),t._uU(39,"Paid"),t.qZA()()(),t.TgZ(40,"tbody"),t.YNc(41,q,8,2,"tr",21),t.qZA()(),t.TgZ(42,"div",22),t._UZ(43,"br"),t.TgZ(44,"nz-pagination",23),t.NdJ("nzPageIndexChange",function(s){return e.onPageChange(s)})("nzPageSizeChange",function(s){return e.onPageSizeChange(s)}),t.qZA(),t._UZ(45,"br"),t.qZA()()()()),2&n&&(t.xp6(7),t.Q6J("formGroup",e.dayCollectionForm),t.xp6(4),t.Q6J("nzSm",6)("nzXs",24),t.xp6(2),t.Q6J("nzSm",14)("nzXs",24),t.xp6(1),t.Q6J("ngModel",e.date)("nzAllowClear",!1),t.xp6(3),t.Q6J("nzSpan",14)("nzOffset",6),t.xp6(6),t.Q6J("ngIf",e.dayBillsList&&e.dayBillsList.length>0),t.xp6(1),t.Q6J("ngIf",e.dayBillsList&&e.dayBillsList.length>0),t.xp6(3),t.Q6J("ngIf",e.dayBillsList&&e.dayBillsList.length>0),t.xp6(1),t.Q6J("ngIf",0===e.dayBillsList.length),t.xp6(1),t.Q6J("nzData",e.dayBillsList)("nzLoading",e.loading)("nzShowPagination",!1),t.xp6(12),t.Q6J("ngForOf",e.dayBillsList),t.xp6(3),t.Q6J("nzPageIndex",e.index)("nzTotal",e.total)("nzShowSizeChanger",!0)("nzPageSize",e.pageSize))},dependencies:[m.sg,m.O5,D.Ls,C.t3,C.SK,c.Lr,c.Nx,c.iK,c.Fd,g._Y,g.JJ,g.JL,g.sg,g.u,P.ix,O.w,M.dQ,S.uw,d.N8,d.Uo,d._C,d.Om,d.p0,d.$Z,x.dE],styles:[".margin-right10[_ngcontent-%COMP%]{margin-right:10px}.margin-right20[_ngcontent-%COMP%]{margin-right:20px}.margin-right25[_ngcontent-%COMP%]{margin-right:25px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}nz-date-picker[_ngcontent-%COMP%]{margin:0 8px 12px 0}input[type=number][_ngcontent-%COMP%]{border:1px solid #d9d9d9!important}input[type=number][_ngcontent-%COMP%]:focus{border:1px solid #40a9ff!important}.text-center[_ngcontent-%COMP%]{text-align:center!important}.text-right[_ngcontent-%COMP%]{text-align:right!important}.print-container[_ngcontent-%COMP%]{padding:25px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border:1px solid #000;padding:10px;background-color:#d3d3d3}td[_ngcontent-%COMP%]{border:1px solid #000;padding:10px}.align-right[_ngcontent-%COMP%]{float:right}@media print{body[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}.print-container[_ngcontent-%COMP%], .print-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:visible}.page-header1[_ngcontent-%COMP%], .page-header2[_ngcontent-%COMP%], button[_ngcontent-%COMP%], .ant-menu[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{display:none}}"]}),o})()}];let N=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.Bz.forChild(L),h.Bz]}),o})();var I=a(9912);let Q=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[m.ez,N,I.m]}),o})()}}]);