"use strict";(self.webpackChunktraders=self.webpackChunktraders||[]).push([[595],{1595:(L,d,i)=>{i.r(d),i.d(d,{BillModule:()=>I});var u=i(6895),p=i(2564),r=i(433),v=i(5439),e=i(4650),C=i(9651),Z=i(2566),S=i(1883),T=i(1102),h=i(3679),z=i(6704),g=i(5635),f=i(8231),b=i(6616),A=i(7044),x=i(1811),B=i(7096),q=i(5259),m=i(7635),F=i(6497),J=i(1243),y=i(1634);function O(o,l){if(1&o&&e._UZ(0,"nz-option",35),2&o){const n=l.$implicit;e.Q6J("nzLabel",n.name)("nzValue",n)}}function Q(o,l){if(1&o&&e._UZ(0,"nz-option",35),2&o){const n=l.$implicit;e.Q6J("nzLabel",n.name)("nzValue",n)}}function M(o,l){if(1&o&&e._UZ(0,"nz-option",35),2&o){const n=l.$implicit;e.Q6J("nzLabel",n.name)("nzValue",n)}}function U(o,l){if(1&o){const n=e.EpF();e.TgZ(0,"span",37),e.NdJ("click",function(){e.CHM(n);const a=e.oxw(2);return e.KtG(a.clearfield("notes"))}),e.qZA()}}function N(o,l){if(1&o&&e.YNc(0,U,1,0,"span",36),2&o){const n=e.oxw();e.Q6J("ngIf",n.validateForm.controls.notes.value)}}function X(o,l){if(1&o){const n=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"a",38),e.NdJ("nzOnConfirm",function(){const s=e.CHM(n).$implicit,c=e.oxw();return e.KtG(c.deleteConfirm(s._id))})("nzOnCancel",function(){e.CHM(n);const a=e.oxw();return e.KtG(a.cancel())}),e._UZ(13,"span",39),e.qZA()()()}if(2&o){const n=l.$implicit;e.xp6(2),e.Oqu(n.customer_name),e.xp6(2),e.Oqu(n.vegetable_name),e.xp6(2),e.Oqu(n.quantity),e.xp6(2),e.Oqu(n.rate),e.xp6(2),e.Oqu(n.total_amount)}}const P=function(){return{standalone:!0}},V=[{path:"",component:(()=>{class o{constructor(n,t,a,s,c){this.fb=n,this.el=t,this.message=a,this.mainService=s,this.farmerService=c,this.customers=[],this.vegetablesList=[],this.farmersList=[],this.date=new Date,this.defaultDate=new Date,this.billsData=[],this.sort=["ascend"],this.listOfColumns=[{name:"Name",sortOrder:"ascend"},{item:"Item",sortOrder:null},{rate:"Rate",sortOrder:null},{quantity:"quantity",sortOrder:null}],this.index=1,this.total=0,this.pageSize=10,this.loading=!0,this.edit=!1,this.switchValue=!1}ngOnInit(){this.validateForm=this.fb.group({customer:[null,[r.kI.required]],quantity:[null,[r.kI.required]],rate:[null,[r.kI.required]],vegetables:[null,[r.kI.required]],farmer:[null,[r.kI.required]],date:[this.date,[r.kI.required]],notes:[null]}),this.total=this.billsData.length,this.getCustomers(),this.getAllFarmers(),this.getAllVegetables(),this.getBills(),this.switchValue=!1}clearfield(n){this.validateForm.controls[n].reset()}getBills(){const n={skip:this.index,limit:this.pageSize};this.loading=!0,this.mainService.getBills(n).subscribe(t=>{this.billsData=t.data,this.total=t.total,document.getElementById("quantityNumber")?.focus(),this.loading=!1},t=>{console.log("get customers err ",t),this.billsData=[],document.getElementById("rate")?.focus(),this.loading=!1})}getCustomers(){this.mainService.getCustomers({}).subscribe(t=>{this.customers=t.data},t=>{console.log("get customers err ",t),this.customers=[]})}getAllFarmers(){this.farmerService.getFarmers({}).subscribe(t=>{this.farmersList=t.data},t=>{console.log("get farmers err ",t),this.farmersList=[]})}getAllVegetables(){this.mainService.getVegetables({}).subscribe(t=>{this.vegetablesList=t.data},t=>{console.log("get customers err ",t),this.vegetablesList=[]})}clickSwitch(){this.switchValue=!this.switchValue}submitForm(){if(this.validateForm.valid){const t={bill_date:v(this.validateForm.value.date).format("YYYY-MM-DDTHH:mm:ss.000"),customer_name:this.validateForm.value.customer.name,customer_id:this.validateForm.value.customer._id,vegetable_name:this.validateForm.value.vegetables.name,vegetable_id:this.validateForm.value.vegetables._id,rate:this.validateForm.value.rate,quantity:this.validateForm.value.quantity,farmer_name:this.validateForm.value.farmer.name,farmer_id:this.validateForm.value.farmer._id,unit_wise:this.switchValue,notes:this.validateForm.value.notes};this.mainService.createBill(t).subscribe(a=>{this.message.create("success","Bill added Successfully"),this.loading=!1,this.ngOnInit()},a=>{console.log("get customers err ",a),this.loading=!1})}else Object.values(this.validateForm.controls).forEach(n=>{n.invalid&&(n.markAsDirty(),n.updateValueAndValidity({onlySelf:!0}))})}onChange(n){}reset(){this.validateForm.controls.quantity.reset(),this.validateForm.controls.rate.reset(),this.validateForm.controls.notes.reset(),this.edit=!1,this.switchValue=!1}deleteConfirm(n){this.loading=!0,this.mainService.removeBill(n).subscribe(t=>{this.loading=!1,t&&t.success&&(this.message.create("success",t.message),this.getBills())},t=>{console.log("get customers err ",t),this.loading=!1})}cancel(){}onPageSizeChange(n){this.pageSize=n,this.getBills()}onPageChange(n){this.index=n,this.getBills()}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(r.QS),e.Y36(e.SBq),e.Y36(C.dD),e.Y36(Z.J),e.Y36(S.y))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-bill"]],decls:86,vars:58,consts:[[1,"customer-form"],["nz-row",""],["nz-col","","nzSpan","12"],["nz-form","","appFocus","",3,"formGroup","ngSubmit"],["nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["formControlName","date",3,"ngModel","nzAllowClear","ngModelChange"],["id","customer",3,"nzSm","nzXs"],["nzShowSearch","","nzAllowClear","","formControlName","customer","id","customersLists"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzFor","quantityNumber","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Add quantity!",3,"nzSm","nzXs"],["id","quantityNumber","formControlName","quantity",3,"min","step"],["nzFor","rate","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Add Rate!",3,"nzSm","nzXs"],["id","rate","formControlName","rate",3,"nzMin","nzStep"],[3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","vegetables","nzRequired","",3,"nzSm","nzXs"],["nzShowSearch","","nzAllowClear","","formControlName","vegetables",1,"phone-selects"],["nzFor","farmer","nzRequired","",3,"nzSm","nzXs"],["nzShowSearch","","nzAllowClear","","formControlName","farmer",1,"phone-selects"],["nzFor","notes",3,"nzSm","nzXs"],["nzErrorTip","Please input your notes!",3,"nzSm","nzXs","nzValidateStatus"],[1,"ant-input-affix-wrapper-textarea-with-clear-btn",3,"nzSuffix"],["nz-input","","formControlName","notes","placeholder","Notes"],["textAreaClearNotes",""],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary"],["nz-button","","nzType","default",3,"click"],[3,"nzData","nzLoading","nzShowPagination"],["basicTable",""],[4,"ngFor","ngForOf"],[1,"text-right"],[3,"nzPageIndex","nzTotal","nzShowSizeChanger","nzPageSize","nzPageIndexChange","nzPageSizeChange"],[3,"nzLabel","nzValue"],["nz-icon","","class","ant-input-clear-icon","nzTheme","fill","nzType","close-circle",3,"click",4,"ngIf"],["nz-icon","","nzTheme","fill","nzType","close-circle",1,"ant-input-clear-icon",3,"click"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this Bill","nzPopconfirmPlacement","bottom",3,"nzOnConfirm","nzOnCancel"],["nz-icon","","nzType","delete","nzTheme","fill"]],template:function(n,t){if(1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3),e.NdJ("ngSubmit",function(){return t.submitForm()}),e.TgZ(4,"nz-form-item")(5,"nz-form-label",4),e._uU(6,"Date"),e.qZA(),e.TgZ(7,"nz-form-control",5)(8,"nz-date-picker",6),e.NdJ("ngModelChange",function(s){return t.date=s})("ngModelChange",function(s){return t.onChange(s)}),e.qZA()()(),e.TgZ(9,"nz-form-item")(10,"nz-form-label",4)(11,"span"),e._uU(12,"Customer"),e.qZA()(),e.TgZ(13,"nz-form-control",7)(14,"nz-select",8),e.YNc(15,O,1,2,"nz-option",9),e.qZA()()(),e.TgZ(16,"nz-form-item")(17,"nz-form-label",10)(18,"span"),e._uU(19,"Quantity"),e.qZA()(),e.TgZ(20,"nz-form-control",11),e._UZ(21,"input",12),e.qZA()(),e.TgZ(22,"nz-form-item")(23,"nz-form-label",13)(24,"span"),e._uU(25,"Rate"),e.qZA()(),e.TgZ(26,"nz-form-control",14),e._UZ(27,"nz-input-number",15),e.qZA()(),e.TgZ(28,"nz-form-item")(29,"nz-form-label",4)(30,"span"),e._uU(31,"Unit wise"),e.qZA()(),e.TgZ(32,"nz-form-control",5)(33,"nz-switch",16),e.NdJ("ngModelChange",function(s){return t.switchValue=s}),e.qZA()()(),e.TgZ(34,"nz-form-item")(35,"nz-form-label",17)(36,"span"),e._uU(37,"Vegetables"),e.qZA()(),e.TgZ(38,"nz-form-control",5)(39,"nz-select",18),e.YNc(40,Q,1,2,"nz-option",9),e.qZA()()(),e.TgZ(41,"nz-form-item")(42,"nz-form-label",19)(43,"span"),e._uU(44,"Farmer"),e.qZA()(),e.TgZ(45,"nz-form-control",5)(46,"nz-select",20),e.YNc(47,M,1,2,"nz-option",9),e.qZA()()(),e.TgZ(48,"nz-form-item")(49,"nz-form-label",21),e._uU(50,"Notes"),e.qZA(),e.TgZ(51,"nz-form-control",22)(52,"nz-input-group",23),e._UZ(53,"textarea",24),e.qZA(),e.YNc(54,N,1,1,"ng-template",null,25,e.W1O),e.qZA()(),e.TgZ(56,"nz-form-item",26)(57,"nz-form-control",27)(58,"button",28),e._uU(59),e.qZA(),e._uU(60,"\xa0 "),e.TgZ(61,"button",29),e.NdJ("click",function(){return t.reset()}),e._uU(62,"Reset"),e.qZA()()()()(),e.TgZ(63,"div",2)(64,"nz-table",30,31)(66,"thead")(67,"tr")(68,"th"),e._uU(69,"Name"),e.qZA(),e.TgZ(70,"th"),e._uU(71,"Item"),e.qZA(),e.TgZ(72,"th"),e._uU(73,"Quantity"),e.qZA(),e.TgZ(74,"th"),e._uU(75,"Rate"),e.qZA(),e.TgZ(76,"th"),e._uU(77,"Total"),e.qZA(),e.TgZ(78,"th"),e._uU(79,"Actions"),e.qZA()()(),e.TgZ(80,"tbody"),e.YNc(81,X,14,5,"tr",32),e.qZA()(),e.TgZ(82,"div",33),e._UZ(83,"br"),e.TgZ(84,"nz-pagination",34),e.NdJ("nzPageIndexChange",function(s){return t.onPageChange(s)})("nzPageSizeChange",function(s){return t.onPageSizeChange(s)}),e.qZA(),e._UZ(85,"br"),e.qZA()()()()),2&n){const a=e.MAs(55);e.xp6(3),e.Q6J("formGroup",t.validateForm),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("ngModel",t.date)("nzAllowClear",!1),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(2),e.Q6J("ngForOf",t.customers),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("min",1)("step",1),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("nzMin",1)("nzStep",1),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("ngModel",t.switchValue)("ngModelOptions",e.DdM(57,P)),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(2),e.Q6J("ngForOf",t.vegetablesList),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(3),e.Q6J("nzSm",14)("nzXs",24),e.xp6(2),e.Q6J("ngForOf",t.farmersList),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",t.validateForm.controls.notes),e.xp6(1),e.Q6J("nzSuffix",a),e.xp6(5),e.Q6J("nzSpan",14)("nzOffset",6),e.xp6(2),e.Oqu(t.edit?"Update":"Create"),e.xp6(5),e.Q6J("nzData",t.billsData)("nzLoading",t.loading)("nzShowPagination",!1),e.xp6(17),e.Q6J("ngForOf",t.billsData),e.xp6(3),e.Q6J("nzPageIndex",t.index)("nzTotal",t.total)("nzShowSizeChanger",!0)("nzPageSize",t.pageSize)}},dependencies:[u.sg,u.O5,T.Ls,h.t3,h.SK,z.Lr,z.Nx,z.iK,z.Fd,r._Y,r.Fj,r.JJ,r.JL,r.On,r.sg,r.u,g.Zp,g.gB,g.ke,f.Ip,f.Vq,b.ix,A.w,x.dQ,B._V,q.uw,m.N8,m.Uo,m._C,m.Om,m.p0,m.$Z,F.JW,J.i,y.dE],styles:["[nz-form][_ngcontent-%COMP%]{max-width:600px}.phone-select[_ngcontent-%COMP%]{width:70px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.customer-form[_ngcontent-%COMP%]{margin-top:20px}nz-date-picker[_ngcontent-%COMP%]{margin:0 8px 12px 0}.text-right[_ngcontent-%COMP%]{text-align:right!important}"]}),o})()}];let w=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[p.Bz.forChild(V),p.Bz]}),o})();var _=i(4973);let I=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.ez,w,_.m,_.m]}),o})()}}]);